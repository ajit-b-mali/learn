# Questions

- What are all node core modules ?
- What is Event Loop / how DOM JS Event handling woork ?
- database server ?
- headers/meta information ?
- protocol ? can I create custom protocol and use it ?
- How someone spoof http? why it is not secure ?
- what is ssl encryption ?
- what is `import { something } from "node:somewhere";` ? what is `node:` ?
- what is `.gitignore` ?
- what is event driven architecture ?
- can we really use any port number ?
- What are req.methods ?
- What are various req.headers ?
- why the req.url output / and /favicon.ico both for a first visit ?
- What are set of supported headers for setHeader ?
- What is chunck ?
- What is 
  1. redirect to different page - redirecting ?
  2. sending variety of data depending on path - routing ?
  3. parse incoming data - parsing ?
- What is routing ?
- GET vs POST vs etc ?
- statuscode 302 -- for redirectio ? other status codes ?
- What is stream & buffer ?
- Buffer class ?
- `fs.writeFileSync("file.txt", "content") vs fs.writeFile("file.txt", "content", (error) => {})` ?
- `node:Buffer` ?
- single thread ? multi thread ? event loop ? blocking code vs non-blocking code ?
-
```
/**
 * @param {{ url: any; method: string; on: (arg0: string, arg1: { (chunk: any): void; (): void; }) => void; }} req
 * @param {{ setHeader: (arg0: string, arg1: string) => void; end: (arg0: string | undefined) => void; statusCode: number; }} res
 */
```
- What is this ?
- export in nodejs ?
- `.js` vs `.cjs` vs `.mjs` vs `.js` with `{ type:module }`

# Creating a Node Server

- create file app.js / server.js (recommonded)
- see [example](../projects/http/server.js)

# require()

- takes a path of a js file or name of a core/third party file
- path to user defined file has to start with `./` -- relative or `/` -- absolute path
- we don't need to specify `.js`

- we can use `process.exit()` to exit the event loop of `Server.listen()`

# http module

- createServer(requestListener?: (request: IncomingMessage, response: ServerResponse) => void): Server
    - requestListener is a function that execute for every incoming request
    - requestListener must have two arguements
        1. request
            - request.url       -> 
            - request.method    ->
            - request.headers   ->
            - req.on()          ->
                - req.on("data", callback) -- callack runs each time a chunck is received
                - req.on("end", callback)` -- callback runs when all data is received
        2. response
            - response.setHeader('Content-Type', 'text/html')   ->
            - response.write('content')                         ->
            - response.end()                                    ->
            - response.statusCode                               ->
            - response.writeHead()                              ->
            - response.setHeaders()                             ->
    - return a server object
        - Server.listen(port?: number, hostname?: string, backlog?: number, listeningListener?: Function): Server
            - keep program running to listen incoming requests
            - port? -- default to 80 -- port number for nodejs - 3000
            - hostname? -- default to localhost -- name of machine running on

# redirecting

- req.statuscode = 302 -- represent redirection
- req.setHeader("Location", "/") -- redirect to root location

# routing

- route the request with condition and req.url, req.method

# parsing

- incoming data sent as a stream of data -- chunk -- a Buffer which contains sequence of bytes
- default size of chunk is ...
- sample Buffer
    - `<Buffer 6e 61 6d 65 3d 61 6a 69 74 26 6d 65 73 73 61 67 65 3d 47 4f 4f 44>` -> name=ajit&message=GOOD
- for every `req.on("data")` a chunk is send
- we collect this chunk in a array
- now on `req.on("end")` this array is concatted and converted to proper format

# using module system

- separating routing logic
    - using special file name `routes.js` -- just a convenience
- `module.exports = routingFunction`
- in server.js -- import that routingFunction and use

# core modules

- fs    -> file system
- path  -> file path
- os    -> operating system
- http  -> launch a server, send requests
- https -> launch a ssl server

# Note

- Calling the write method after calling end will raise an error.
- we can see response and request neatly from inspect->network from browser
- sending response early doesn't mean event listener will be dead
- but we can't do anything about response if response is send early

# Extras

- multiple servers can communicate, example -- send request to google map and get co-ordinates
- keep the name of import same as library
- we can `curl http://localhost:3000` to send request from terminal
- we can access this server even with a simple index file without any server
    - by doing this -- `action="http://localhost:3000/feedback"`

## Working of Web

- web uses HTTP/HTTPS
- see [summary](./img1.png)
- see [blog](../blogs/working-of-web.md)

# ABBR

- HTTP -- Hyper Text Transfer Protocol -- A protocol for transferring data which is unnderstood by browser ans server
- HTTPS -- Hyper Text Transfer Protocol Secure -- HTTP + Data Encryption

<!-- END -->

